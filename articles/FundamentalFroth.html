<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="froth">
<title>Fundamental Froth • froth</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.2.2/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.2.2/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Fundamental Froth">
<meta property="og:description" content="froth">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">froth</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.ahl27.com/froth/articles/froth.html">Overview</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tutorial">Tutorial</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tutorial">
    <a class="external-link dropdown-item" href="https://www.ahl27.com/froth/articles/FundamentalFroth.html">1. Fundamental Froth</a>
    <a class="external-link dropdown-item" href="https://www.ahl27.com/froth/articles/ArithmeticAndStacks.html">2. Arithmetic and Stacks</a>
    <a class="external-link dropdown-item" href="https://www.ahl27.com/froth/articles/Conditionals.html">3. Conditionals</a>
    <a class="external-link dropdown-item" href="https://www.ahl27.com/froth/articles/Loops.html">4. Loops</a>
    <a class="external-link dropdown-item" href="https://www.ahl27.com/froth/articles/Variables.html">5. Variables</a>
    <a class="external-link dropdown-item" href="https://www.ahl27.com/froth/articles/RInterface.html">6. Interfacing with R</a>
    <a class="external-link dropdown-item" href="https://www.ahl27.com/froth/articles/Glossary.html">Glossary</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.ahl27.com/tutorials" aria-label="Homepage">
    <span class="fa fa-user"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ahl27/froth" aria-label="GitHub">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Fundamental Froth</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ahl27/froth/blob/HEAD/vignettes/FundamentalFroth.Rmd" class="external-link"><code>vignettes/FundamentalFroth.Rmd</code></a></small>
      <div class="d-none name"><code>FundamentalFroth.Rmd</code></div>
    </div>

    
    
<p><code>froth</code> attempts to stick close to the original
conventions of Froth. Let’s walk through the basics using the built-in
commandline.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://www.ahl27.com/froth/" class="external-link">froth</a></span><span class="op">)</span></span>
<span><span class="co">## start the command line</span></span>
<span><span class="fu"><a href="../reference/froth-package.html">froth</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<p>You should see your console change to look like the following:</p>
<pre><code>&gt; library(froth)
&gt; froth()
fr&gt;</code></pre>
<p>This <code>fr&gt;</code> signals that you’re currently in the
<code>froth</code> environment. Let’s test it by pressing
<code>ENTER</code>:</p>
<pre><code>fr&gt;
ok.
fr&gt;</code></pre>
<p><code>froth</code> will acknowledge successfully completed commands
with <code>ok.</code>. In this case, we didn’t provide any commands, so
<code>froth</code> will simply do nothing and acknowledge you.</p>
<p>Let’s try a new command:</p>
<pre><code>fr&gt; 45 emit
-ok.</code></pre>
<p>Notice how the return is now <code>-ok.</code>? This is because
<code>froth</code> ran the commands <code>45</code> and
<code>emit</code> before returning. <code>45</code> pushes the number 45
onto the stack, and <code>emit</code> prints the top value of the stack
interpreting it as an ASCII value. 45 happens to correspond to a dash in
ASCII, so we get a dash printed!</p>
<p>Now, it would certainly be possible to print out lines by just
repeating this command over and over:</p>
<pre><code>fr&gt; 45 emit 45 emit 45 emit 45 emit 45 emit
-----ok.</code></pre>
<p>…but this gets a little tiresome. Instead, let’s tell
<code>froth</code> a shortcut for when we want to print a dash:</p>
<pre><code>fr&gt; : DASH 45 emit ;
ok.
fr&gt; DASH
-ok.</code></pre>
<p>What happened here? The colon <code>:</code> tells <code>froth</code>
that we’re starting a definition. The next word (<code>DASH</code>)
gives the name for this definition, and the remaining words define what
it does. The semicolon <code>;</code> ends the definition. In this case,
we’re telling <code>froth</code>: “whenever you see the word ‘dash’,
replace it with <code>45 emit</code>.” After that, we call
<code>dash</code> and it prints out a dash. Note that words are not
case-sensitive; <code>dash</code>, <code>dAsH</code>, and
<code>DASH</code> will all work. These names with associated definitions
are called <em>words</em>!</p>
<p>We can even make words that include words. This word prints out an
arbitrary number of dashes (I’ll explain how it works later):</p>
<pre><code>fr&gt; : DASHES 0 do dash loop ;
ok.
fr&gt; 10 dashes
----------ok.</code></pre>
<p>Now, let’s make a word that prints out an ASCII letter
<code>F</code>, for froth. We’re going to add in a few more new words:
<code>CR</code>, which prints a new line, and <code>124 emit</code>,
which prints a pipe (<code>|</code>).</p>
<pre><code>fr&gt; : PIPE 124 emit ;
ok.
fr&gt; : LETTER_F 47 emit 4 dashes cr pipe 2 dashes cr pipe cr ;
/----
|--
|
ok.</code></pre>
<p>It’s not as pretty as the asterisk F in <em>Starting FORTH</em>, but
what can ya do.</p>
<div class="section level2">
<h2 id="the-dictionary">The Dictionary<a class="anchor" aria-label="anchor" href="#the-dictionary"></a>
</h2>
<p>The dictionary in FORTH is a list of words defined sequentially.
<code>froth</code> initializes some words when it first loads, and then
user-defined words are added sequentially to it. When you input a line
of text, <code>froth</code> splits the command by spaces and searches
for each word in the dictionary. If it finds the word, it executes the
related code. If not, it returns an error message.</p>
<p>This means you <strong>must</strong> separate each command by a
space! For example:</p>
<pre><code>fr&gt; :star 42 emit ;
:star ?</code></pre>
<p><code>froth</code> couldn’t understand this command, and responded
with <code>:star ?</code>. This is because <code>:star</code> isn’t a
defined word–in order to make this definition work, we have to
space-separate the colon from the other words.</p>
<pre><code>fr&gt; : star 42 emit ;
ok.
fr&gt; star
*ok.</code></pre>
<p>Emitting values character by character gets old pretty fast. We can
use the words <code>."</code> and <code>"</code> to print whole
strings:</p>
<pre><code>fr&gt; ." Hello, world!"
Hello, world! ok.</code></pre>
<p>Note the space separation between <code>."</code> and the string. The
ending <code>"</code> is part of the string, so it doesn’t need to be
space separated.</p>
<p><code>froth</code> also has some special words. We encountered one of
these before when we input <code>45</code>–this put the number 45 onto
the stack. If <code>froth</code> can’t find a word in the dictionary, it
checks to see if you’ve input a number. If so, it executes a special
command that puts it onto the stack.</p>
<p>You can redefine a word at any time by just writing a new definition
for it. <code>froth</code> will always use the most recent definition
for a word that you’ve given it, but it remembers old ones. If you
wanted to go back to a previous definition, you can use the
<code>FORGET</code> word.</p>
<pre><code>fr&gt; : add_two 2 + ; 
ok.
fr&gt; : add_two 2 2 + + ;
ok.
fr&gt; 5 add_two .
9 ok.
fr&gt; forget add_two
ok.
fr&gt; 5 add_two
7 ok.
fr&gt; forget add_two
ok.
fr&gt; 5 add_two
add_two ?</code></pre>
<p>Here we define <code>add_two</code> twice–the first defines it as
adding two to a number, and the second as adding four. When we call
<code>forget add_two</code>, it reverts to the first definition. Calling
it a second time removes the definition entirely.</p>
<p>If you’re curious what words are defined, you can list them all out
using the <code>WORDS</code> words.</p>
</div>
<div class="section level2">
<h2 id="the-data-stack">The Data Stack<a class="anchor" aria-label="anchor" href="#the-data-stack"></a>
</h2>
<p>We’ve been talking a lot about the stack, but…what is it? If you’re
unfamiliar with the stack data structure, the concept is essentially the
same as a tower of bricks. Each time we “add” to the stack, we place a
brick on top of the tower. Each time we remove from the stack, we have
to take the brick off the top, otherwise the entire stack would fall
apart! This means that the most recently added brick is always the first
one we remove. This concept is typically referred to as “Last In, First
Out” (LIFO).</p>
<p>When we talk about stacks, we use the word “push” to refer to adding
an item to the stack, and “pop” to refer to taking an item off the
stack.</p>
<p>Let’s showcase this with an example. We’re going to use a new word
called <code>.</code>. The period takes the first element off the stack
and tells you what it was (it pops an item).</p>
<pre><code>fr&gt; 1
ok.
fr&gt; 2
ok.
fr&gt; 3
ok.
fr&gt; . . .
3 2 1 ok.</code></pre>
<p>Note how the last element we added (3) was the first element we got
back. LIFO in action.</p>
<p>Stacks lend themselves well to a style of expression notation called
reverse Polish notation (RPN), also called <strong>postfix</strong>
notation. Most people are used to <strong>infix</strong> notation, in
which operators are found in between their operands. This means that if
you wanted to add two numbers <code>a</code> and <code>b</code>, you’d
write <code>a + b</code>. Postfix notation instead puts the operator
<em>after</em> the operands, meaning that we’d write the sum of
<code>a</code> and <code>b</code> as <code>a b +</code>.</p>
<p>While this may feel unintuitive, it does have a number of benefits.
First, postfix notation has no need for parentheses or order of
operations; the operations define the order they should be applied. For
example:</p>
<pre><code>(infix) a * (b+c) = a b c + * (postfix)
(infix) (a*b) + (c*d) = a b * c d * + (postfix)</code></pre>
<p>This works especially well for <code>froth</code>, since we have a
stack already! If we write any operation in postfix notation, we’ll get
the result. Let’s try that with some simple arithmetic:</p>
<pre><code>fr&gt; : pop_result . cr ;
fr&gt; 1 2 + pop_result
3 
ok.
fr&gt; 2 3 4 + * pop_result
14
ok.
fr&gt; 2 3 * 4 5 * + pop_result
26</code></pre>
<p>Walking through each of these expressions:</p>
<ul>
<li><code>1 2 + =&gt; 1 + 2 + 3</code></li>
<li><code>2 3 4 + * =&gt; 2 * (3+4) = 2*7 = 14</code></li>
<li><code>2 3 * 4 5 * + =&gt; (2*3) + (4*5) = 6 + 20 = 26</code></li>
</ul>
<p>What is actually going on under the hood? Let’s walk through
<code>1 2 + pop_result</code>:</p>
<ol style="list-style-type: decimal">
<li>
<code>froth</code> reads <code>1</code>, and pushes a 1 onto the
stack.</li>
<li>
<code>froth</code> reads <code>2</code>, and pushes a 2 onto the
stack.</li>
<li>
<code>froth</code> reads <code>+</code>.</li>
<li>
<code>+</code> pops two items off the stack (2, 1).</li>
<li>
<code>+</code> adds the two items it just popped (1 + 2).</li>
<li>
<code>+</code> pushes the result of the operation (3) back onto the
stack.</li>
<li>
<code>froth</code> reads <code>pop_result</code>, and looks up the
definition (<code>. cr</code>).</li>
<li>
<code>pop_result</code> first calls <code>.</code>, which pops the
first element of the stack (3).</li>
<li>
<code>pop_result</code> then calls <code>cr</code>, which prints a
new line.</li>
<li>
<code>froth</code> sees no more commands, so it acknowledges with
<code>ok.</code>
</li>
</ol>
<p>A nice thing about postfix operators is we can implicitly act on
whatever is on the stack. For example, it’s relatively easy to define a
word that doubles whatever is on the stack:</p>
<pre><code>fr&gt; : double 2 * ;
ok.</code></pre>
<p>Wait a second–doesn’t <code>*</code> pop two values and then return?
Here we’ve only defined a single value, 2!</p>
<p>This construction is by design. <code>*</code> pops whatever the top
two values of the stack are, multiplies them, then pushes the result.
This means that, since we’re only pushing a single value in
<code>double</code>, the function will multiply whatever is on top of
the stack by two and then return it.</p>
<pre><code>fr&gt; 1
ok.
fr&gt; double double double double .
16 ok.</code></pre>
</div>
<div class="section level2">
<h2 id="watch-out-for-the-stack">Watch out for the stack!<a class="anchor" aria-label="anchor" href="#watch-out-for-the-stack"></a>
</h2>
<p>It’s important to note a major concern with this style of
architecture. Let’s return to our definition of <code>double</code>:</p>
<pre><code>fr&gt; : double 2 * ;
ok.</code></pre>
<p>I mentioned before that this allows us to arbitrarily double whatever
is on top of the stack. However, what happens if there’s nothing on top
of the stack? Let’s use the <code>clear</code> word to remove all
elements from the stack, then run <code>double</code>:</p>
<pre><code>fr&gt; clear
ok.
fr&gt; double
Error: stack is empty.
&gt;</code></pre>
<p>This is called a stack underflow error, and it kills our froth
session. We can reinitialize it with <code><a href="../reference/froth-package.html">froth()</a></code> (and this will
preserve all of our defined words), but it’s important to exercise
caution when dealing with the stack. Make sure that you’re aware of what
state your words expect and what state they leave the stack in!</p>
<p>Conventional Forth communicates this by adding comments to words.
Comments are added using the <code>( )</code> words, and are typically
of the form <code>( before_state -- after_state )</code> (note space
separation of parentheses; they’re also words!).</p>
<p>For example:</p>
<pre><code>fr&gt; : DOUBLE ( n1 -- n2 ) 2 * ;
ok.</code></pre>
<p>In this case, <code>DOUBLE</code> expects to find a single number
<code>n1</code> on the stack, and it replaces it with <code>n2</code>.
In essence, we expect to find at least one value, and we end with one
value.</p>
<p>Another example:</p>
<pre><code>fr&gt; : SUM ( a b -- res ) + ;
ok.</code></pre>
<p><code>SUM</code> is equivalent to the <code>+</code> operation.
<code>+</code> expects to find at least two elements on the stack
(<code>a,b</code>), and replaces them with <code>res</code>.</p>
<p>Operations don’t have to replace. The notation for <code>emit</code>
is simply <code>: emit ( n -- )</code>, since it pops an element off the
stack but doesn’t replace it.</p>
</div>
<div class="section level2">
<h2 id="when-all-goes-wrong">When all goes wrong<a class="anchor" aria-label="anchor" href="#when-all-goes-wrong"></a>
</h2>
<p>If you find yourself in a real pickle, the <code>RESET</code> word
will completely reset the <code>froth</code> environment to when its
first initialized. You can also use <code>CTRL+C</code> to kill any
running processes, and <code>CLEAR</code> to delete the contents of the
stack.</p>
</div>
<div class="section level2">
<h2 id="words-in-this-chapter">Words in this chapter<a class="anchor" aria-label="anchor" href="#words-in-this-chapter"></a>
</h2>
<ul>
<li>
<code>&lt;NUMBER&gt; ( -- n )</code> : pushes a number onto the
stack</li>
<li>
<code>emit ( n -- )</code> : prints the top number of the stack,
interpreting as ASCII</li>
<li>
<code>cr ( -- )</code>: prints a new line</li>
<li>
<code>." xxx" ( -- )</code>: prints <code>xxx</code> on the
terminal. Note that <code>"</code> terminates the string.</li>
<li>
<code>: xxx yyy ; ( -- )</code> : defines a word <code>xxx</code>
comprised of words <code>yyy</code>
</li>
<li>
<code>+ (a b -- n)</code>: adds <code>a+b</code>
</li>
<li>
<code>* (a b -- n)</code>: multiplies <code>a*b</code>
</li>
<li>
<code>. (n -- )</code>: pops the top element of stack and prints
it</li>
<li>
<code>clear ( x1 x2 ... -- )</code>: removes all elements of the
stack</li>
<li>
<code>reset ( -- )</code>: reset <code>froth</code> to defaults
(wipe all user definitions, reinitialize all built-in definitions, reset
all stacks)</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Aidan Lakshman.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
