<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="froth">
<title>Variables, Constants, and Arrays • froth</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Variables, Constants, and Arrays">
<meta property="og:description" content="froth">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">froth</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.ahl27.com/froth/articles/froth.html">Overview</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tutorial">Tutorial</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tutorial">
    <a class="external-link dropdown-item" href="https://www.ahl27.com/froth/articles/FundamentalFroth.html">1. Fundamental Froth</a>
    <a class="external-link dropdown-item" href="https://www.ahl27.com/froth/articles/ArithmeticAndStacks.html">2. Arithmetic and Stacks</a>
    <a class="external-link dropdown-item" href="https://www.ahl27.com/froth/articles/Conditionals.html">3. Conditionals</a>
    <a class="external-link dropdown-item" href="https://www.ahl27.com/froth/articles/Loops.html">4. Loops</a>
    <a class="external-link dropdown-item" href="https://www.ahl27.com/froth/articles/Variables.html">5. Variables</a>
    <a class="external-link dropdown-item" href="https://www.ahl27.com/froth/articles/RInterface.html">6. Interfacing with R</a>
    <a class="external-link dropdown-item" href="https://www.ahl27.com/froth/articles/Glossary.html">Glossary</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.ahl27.com/tutorials" aria-label="Homepage">
    <span class="fa fa-user"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ahl27/froth" aria-label="GitHub">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Variables, Constants, and Arrays</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ahl27/froth/blob/HEAD/vignettes/Variables.Rmd" class="external-link"><code>vignettes/Variables.Rmd</code></a></small>
      <div class="d-none name"><code>Variables.Rmd</code></div>
    </div>

    
    
<p>Forth-like languages are nice because they don’t require a lot of
variables. However, sometimes there’s a problem that requires saving a
particular value for later usage that can’t be on the stack. This is
where variables, constants, and arrays come in.</p>
<div class="section level2">
<h2 id="variables">Variables<a class="anchor" aria-label="anchor" href="#variables"></a>
</h2>
<p>Let’s say we want to store a value somewhere outside of the stack. We
can initialize a variable using the <code>VARIABLE</code> word.</p>
<pre><code>fr&gt; VARIABLE testvar
ok.</code></pre>
<p>Nothing happened! That’s because this word only allocates space for a
variable without doing any other actions. We can now call the name of
the variable at any time to push its address onto the stack. In Forth,
this would be an actual memory address. <code>froth</code>, however,
uses an abstracted memory map.</p>
<pre><code>fr&gt; test .s
[[1]]
[1] "addr &lt;test, cell 0&gt;"

[[2]]
NULL

ok.</code></pre>
<p>We can see the address of the variable at the top of the stack. We’ll
come back to the <code>cell 0</code> bit later.</p>
<p>To store a value in a variable, we use <code>!</code>. We can copy
the value in an address to the stick using <code>@</code>.</p>
<pre><code>fr&gt; variable newvar
ok.
fr&gt; 20 newvar !
ok.
fr&gt; newvar @ .
20 ok.</code></pre>
<p>Notice that for <code>!</code> we push the value first, then the
address. It’s also important to note that the variable retains its value
even after calling <code>@</code>.</p>
<pre><code>fr&gt; variable newvar
ok.
fr&gt; 20 newvar !
ok.
fr&gt; newvar dup @ . dup @ . @ .
20 20 20 ok.</code></pre>
<p><code>@ .</code> is a pretty common call to inspect the value of a
variable. In fact, it’s so common that there’s a shortcut word to
perform both, <code>?</code>.</p>
<pre><code>fr&gt; variable newvar 20 newvar !
ok.
fr&gt; newvar ?
20 ok.</code></pre>
<p>Variables are often useful as counters, using the <code>+!</code>
command. <code>+!</code> is similar to <code>!</code>, except that it
adds to the variable rather than replacing it.</p>
<pre><code>fr&gt; variable newvar 
ok.
fr&gt; 0 newvar !
ok.
fr&gt; 5 0 do 1 newvar +! loop newvar ?
5 ok.</code></pre>
</div>
<div class="section level2">
<h2 id="constants">Constants<a class="anchor" aria-label="anchor" href="#constants"></a>
</h2>
<p>Sometimes we just need a name for a value. Variables that will never
change values are called constants, and can be fittingly be defined with
the <code>CONSTANT</code> word.</p>
<pre><code>fr&gt; 100 CONSTANT hundred
ok.
fr&gt; hundred .
100 ok.</code></pre>
<p>Constants avoid the hassle of dealing with addresses, and can be
accessed slightly faster than variables. Calling the name of the
variable copies its value directly onto the stack.</p>
</div>
<div class="section level2">
<h2 id="arrays">Arrays<a class="anchor" aria-label="anchor" href="#arrays"></a>
</h2>
<p>Remember when I said we’d come back to that whole
“<code>cell 0</code>” thing? By default, initializing a variable creates
space for one “thing” at an address. Unlike Forth, <code>froth</code>
creates this space at an abstracted memory location, and that space is
big enough for any arbitrary R object. However, sometimes it’s nice to
have a variable that can store more than one value, like in the case of
vectors or lists in R.</p>
<p>Let’s start by initializing an array. The definition proceeds like in
normal variables, we just have to further specify that we want the
variable to be larger than a single value:</p>
<pre><code>fr&gt; VARIABLE myarray 5 CELLS ALLOT
ok.</code></pre>
<p>This initializes a variable with 5 slots for things. Internally, this
is the same as a length 5 list. The word <code>ALLOT</code> allots
memory for the preceding variable, and we’ll come back to
<code>CELLS</code> in a moment.</p>
<p>Previously, we saw this behavior:</p>
<pre><code>fr&gt; myarray .s
[[1]]
[1] "addr &lt;myarray, cell 0&gt;"

[[2]]
NULL

ok.</code></pre>
<p><code>cell 0</code> means that this address is pointing to the first
value of the array <code>myarray</code>. Cells are 0-indexed in
<code>froth</code>, so this is the first entry in the array. Now as
before, we can store a value at the first cell. I’m assuming the address
is still on the stack, so remember we need to call <code>swap</code> to
ensure the top value is the address.</p>
<pre><code>fr&gt; 1 swap !
ok.
fr&gt; myarray ?
1 ok.</code></pre>
<p>Ok, now we can look at the word <code>CELLS</code>. Let’s start by
inspecting what we get by pushing <code>CELLS</code> to the stack:</p>
<pre><code>fr&gt; 4 CELLS .s clear
[[1]]
[1] "addr &lt;, cell 4&gt;"

[[2]]
NULL

ok.</code></pre>
<p>It’s the fourth cell of…nothing? <code>CELLS</code> creates a unique
kind of address–it stores cell number, but it doesn’t point to any
variable. Words like <code>ALLOT</code> expect one of these objects to
tell it how much space to allocate. While <code>CELLS</code> calls don’t
point to anything, we can add them to variable addresses to get to other
values in the array.</p>
<pre><code>fr&gt; myarray
ok.
fr&gt; 4 CELLS + .s
[[1]]
[1] "addr &lt;myarray, cell 4&gt;"

[[2]]
NULL

ok.</code></pre>
<p>Notice how we’ve now gotten an address to <code>myarray</code> that’s
offset by 4 cells. Since the size of <code>myarray</code> is 5, this is
the final entry in the array (indexing starts at 0, so the 5 entries are
0-4). This address works like the examples in the Variables section, so
we can use <code>!</code>, <code>@</code>, <code>+!</code>, and
<code>?</code> on it:</p>
<pre><code>fr&gt; VARIABLE myarray 5 CELLS ALLOT
ok.
fr&gt; 0 BEGIN dup 5 &lt; WHILE dup dup myarray swap CELLS + ! 1 + REPEAT drop
ok.</code></pre>
<p>Here we’re putting it all together. See if you can guess what the
contents of <code>myarray</code> now look like before reading the next
section.</p>
<p>We start by initializing an array <code>myarray</code> of size 5.
Then, we put <code>0</code> on the stack and <code>begin</code> a loop.
At each iteration of the loop we:</p>
<ol style="list-style-type: decimal">
<li>Dup the top of the stack and check if less than 5; if not, go to
(8)</li>
<li>Dup the top of the stack twice.</li>
<li>Load the address of <code>myarray</code>, swap it with the top
duplicate</li>
<li>Create a cell offset equal to the top duplicate, add to the address
of <code>myarray</code>
</li>
<li>Store the second duplicate (from 2) at the offset location</li>
<li>Add 1 to the value on the stack</li>
<li>loop</li>
<li>finish loop</li>
</ol>
<p>So what happens? When the stack is 0, we store 0 at the 0th position
of <code>myarray</code>, then 1 at the 1st position, 2 at the second,
etc. Let’s print out the entire array:</p>
<pre><code>fr&gt; 5 0 do myarray i cells + ? loop
0 1 2 3 4 ok.</code></pre>
<p>It’s also possible to initialize an array to a specific value using
the <code>CREATE</code> and <code>,</code> words. <em>Pay very close
attention to this syntax!</em></p>
<pre><code>fr&gt; CREATE myarray 0 , 1 , 2 , 3 , 4 ,
ok.
fr&gt; 5 0 do myarray i cells + ? loop
0 1 2 3 4 ok.</code></pre>
<p>Did you notice how we used <code>,</code>? Unlike English,
<code>,</code> is a <code>froth</code> word, meaning that it needs to be
space separated and it acts upon the stack. This means that we
<strong>must</strong> include a command after the last element to ensure
it’s added to the array.</p>
</div>
<div class="section level2">
<h2 id="modifying-arrays">Modifying Arrays<a class="anchor" aria-label="anchor" href="#modifying-arrays"></a>
</h2>
<p>It’s often useful to be able to quickly change the values or the size
of allocated arrays.</p>
<p>To change the values in an array, we can use the <code>FILL</code>
word. <code>FILL</code> expects three items on the stack: a variable
address, a <code>CELLS</code> offset <code>n</code>, and a value
<code>x</code>. It then fills the first <code>n</code> cells with
<code>x</code>.</p>
<pre><code>fr&gt; variable filltest 3 cells allot
ok.
fr&gt; 3 0 do i filltest i cells + ! loop
ok.
fr&gt; 3 0 do filltest i cells + ? loop
0 1 2 ok.
fr&gt; filltest 3 cells 10 fill
ok.
fr&gt; 3 0 do filltest i cells + ? loop
10 10 10 ok.</code></pre>
<p>There’s also the shortcut word <code>ERASE</code>, which is
equivalent to <code>0 FILL</code>.</p>
<pre><code>fr&gt; filltest 3 cells erase
ok.
fr&gt; 3 0 do filltest i cells + ? loop
0 0 0 ok.</code></pre>
<p>That changes values, but what if we end up with the wrong size array
altogether? For that, we have two options: <code>EXTEND</code> and
<code>REALLOT</code>. Both of these words have the same form; they
expect the stack to be comprised of a variable address <code>v</code>
and a value <code>n</code>. <code>EXTEND</code> will make the array at
<code>v</code> larger by <code>n</code> cells, and <code>REALLOT</code>
will change <code>v</code> to have exactly <code>n</code> cells (copying
the contents of the first <code>n</code> cells, if any).</p>
<pre><code>fr&gt; variable myarray 3 cells allot
ok.
fr&gt; myarray 5 cells + ?
Error: array accessed out of bounds!
fr&gt; myarray 2 cells extend
ok.
fr&gt; myarray 5 cells + ?
0 ok.
fr&gt; 10 myarray 1 cells + !
ok.
fr&gt; myarray 3 cells reallot
ok.
fr&gt; myarray 5 cells + ?
Error: array accessed out of bounds!
fr&gt; myarray 1 cells + ?
10 ok.</code></pre>
<p>If you’re ever unsure about how large your array is, use the
<code>LENGTH</code> word to copy the length of an address to the stack,
and <code>LENGTH?</code> to print it out.</p>
<pre><code>fr&gt; variable myarray 10 cells allot
ok.
fr&gt; myarray LENGTH .
10 ok.
fr&gt; myarray 20 cells reallot
ok.
fr&gt; myarray LENGTH?
20 ok.</code></pre>
</div>
<div class="section level2">
<h2 id="words-in-this-chapter">Words in this chapter<a class="anchor" aria-label="anchor" href="#words-in-this-chapter"></a>
</h2>
<ul>
<li>
<code>VARIABLE xxx</code>: creates a variable named
<code>xxx</code>
</li>
<li>
<code>! ( n addr -- )</code>: stores the value <code>n</code> at
address <code>addr</code>
</li>
<li>
<code>@ ( addr -- n )</code>: copies the value at <code>addr</code>
to the stack</li>
<li>
<code>? ( addr -- )</code>: prints the value of
<code>addr</code>
</li>
<li>
<code>+! ( n addr -- )</code>: adds the value <code>n</code> to the
value at <code>addr</code>
</li>
<li>
<code>CONSTANT xxx (n -- )</code>: creates a constant called
<code>xxx</code> that stores <code>n</code>; <code>xxx</code> returns
<code>n</code> when called</li>
<li>
<code>ALLOT ( addr ncells -- )</code>: allocates <code>ncells</code>
cells at <code>addr</code>
</li>
<li>
<code>CREATE xxx y1 , y2 , ... yn ,</code>: creates an array
<code>xxx</code> with values <code>y1, y2, ... yn</code>
</li>
<li>
<code>CELLS ( n -- )</code>: creates a memory address offset for
arrays</li>
<li>
<code>FILL ( addr ncells val -- )</code>: fills <code>ncells</code>
cells of memory beginning at <code>addr</code> with
<code>val</code>
</li>
<li>
<code>ERASE ( addr ncells -- )</code>: fills <code>ncells</code>
cells of memory beginning at <code>addr</code> with 0</li>
<li>
<code>REALLOT ( addr ncells -- )</code>: reallots array at
<code>addr</code> to have size <code>ncells</code>.</li>
<li>
<code>EXTEND ( addr ncells -- )</code>: extends the array at
<code>addr</code> by <code>ncells</code> cells</li>
<li>
<code>LENGTH ( addr -- len )</code>: pushes the length of the array
at <code>addr</code> onto the stack</li>
<li>
<code>LENGTH? ( addr -- )</code>: prints the length of the array at
<code>addr</code>
</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Aidan Lakshman.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
