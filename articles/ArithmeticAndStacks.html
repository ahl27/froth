<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="froth">
<title>Arithmetic and Stacks • froth</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Arithmetic and Stacks">
<meta property="og:description" content="froth">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-dark navbar-expand-lg bg-primary"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">froth</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.0</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.ahl27.com/froth/articles/froth.html">Overview</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-tutorial">Tutorial</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-tutorial">
    <a class="external-link dropdown-item" href="https://www.ahl27.com/froth/articles/FundamentalFroth.html">1. Fundamental Froth</a>
    <a class="external-link dropdown-item" href="https://www.ahl27.com/froth/articles/ArithmeticAndStacks.html">2. Arithmetic and Stacks</a>
    <a class="external-link dropdown-item" href="https://www.ahl27.com/froth/articles/Conditionals.html">3. Conditionals</a>
    <a class="external-link dropdown-item" href="https://www.ahl27.com/froth/articles/Loops.html">4. Loops</a>
    <a class="external-link dropdown-item" href="https://www.ahl27.com/froth/articles/Variables.html">5. Variables</a>
    <a class="external-link dropdown-item" href="https://www.ahl27.com/froth/articles/RInterface.html">6. Interfacing with R</a>
    <a class="external-link dropdown-item" href="https://www.ahl27.com/froth/articles/Glossary.html">Glossary</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://www.ahl27.com/tutorials" aria-label="Homepage">
    <span class="fa fa-user"></span>
     
  </a>
</li>
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/ahl27/froth" aria-label="GitHub">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Arithmetic and Stacks</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/ahl27/froth/blob/HEAD/vignettes/ArithmeticAndStacks.Rmd" class="external-link"><code>vignettes/ArithmeticAndStacks.Rmd</code></a></small>
      <div class="d-none name"><code>ArithmeticAndStacks.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="more-arithmetic">More Arithmetic<a class="anchor" aria-label="anchor" href="#more-arithmetic"></a>
</h2>
<p>In the last section, we learned some basic arithmetic using
<code>+</code> and <code>*</code>. However, <code>froth</code>
incorporates a host of arithmetic expressions. Eagle-eyed readers may
have spotted that we’ve only been working with commutative operations,
meaning the order doesn’t matter (<code>a+b = b+a</code>). What happens
when we use non-commutative expressions, such as division or
exponentiation?</p>
<p>When <code>froth</code> executes words, it always treats the top of
the stack as the <em>last</em> argument to the expression. This means
that, for something like <code>a b /</code>, <code>b</code> is on the
top of the stack and the result is <code>a / b</code>.
<code>froth</code> uses R for its mathematical operations, so you don’t
have to worry about things like converting between integers and doubles,
or double vs. single length numbers.</p>
<p>The following mathematical operations are all built into
<code>froth</code>:</p>
<ul>
<li>
<code>/ ( a b -- n )</code>: division
(<code>5 2 / =&gt; 2.5</code>)</li>
<li>
<code>%/% ( a b -- n)</code>: integer division
(<code>5 2 %/% =&gt; 2</code>)</li>
<li>
<code>mod ( a b -- rem )</code>: remainder when dividing
<code>a / b</code>
</li>
<li>
<code>/mod ( a b -- rem quot )</code>: integer divides
<code>a %/% b</code>, pushes the remainder and then the quotient</li>
<li>
<code>^ ( a b -- n )</code>: raises <code>a^b</code>
</li>
<li>
<code>negate ( a -- n )</code>: negates <code>a</code>
</li>
<li>
<code>abs ( a -- n )</code>: takes the absolute value of
<code>a</code>
</li>
<li>
<code>min ( a b -- min )</code>: pushes <code>min(a,b)</code>
</li>
<li>
<code>max ( a b -- max )</code>: pushes <code>max(a,b)</code>
</li>
<li>
<code>sqrt ( a -- root )</code>: pushes <code>sqrt(a)</code>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="stack-operators">Stack Operators<a class="anchor" aria-label="anchor" href="#stack-operators"></a>
</h2>
<p>Unfortunately, there are some problems that just can’t be solved with
stacks and postfix…at least, not without more tools. Consider the
equation <code>(a-b)/c</code>. In postfix, this would be
<code>a b - c /</code>. Now, if we wanted to write a word with
definition <code>( c a b -- d )</code> that applies the function
<code>(a-b)/c</code>, you’d find that it isn’t quite possible with the
tools we have. Defining <code>: SOLUTION? - /</code> would instead apply
<code>c / (a - b)</code>, which isn’t quite right. What we need is a way
to <em>swap</em> the top two values, so that we run
<code>(a-b)/c</code>.</p>
<p>This is where stack operators come in handy. The operator we’re
looking for is the aptly named <code>SWAP ( a b -- b a )</code>. which
swaps the first two elements of the stack. Using this, we can write our
definition:</p>
<pre><code>fr&gt; : TRYTHIS ( c a b -- d ) - swap / ;
ok.
fr&gt; 4 2 1 trythis .
0.25 ok.</code></pre>
<p><code>(2-1)/4 = 1/4 = 0.25</code>, so this works! Here are a couple
other stack operators that are often useful:</p>
<ul>
<li>
<code>SWAP ( a b -- b a )</code>: swap top two stack elements</li>
<li>
<code>DUP ( n -- n n )</code>: duplicate the top stack element</li>
<li>
<code>OVER ( a b -- a b a )</code>: duplicate the second element to
the top of the stack</li>
<li>
<code>ROT ( a b c -- b c a )</code>: rotate the third item to the
top</li>
<li>
<code>DROP ( n -- )</code>: discard the top element of the
stack</li>
<li>
<code>.S ( -- )</code>: print out the contents of the stack</li>
</ul>
<p>We also have a set of stack operators that work on <em>pairs</em> of
numbers, but perform the same functions:</p>
<ul>
<li>
<code>2SWAP ( a b c d -- c d a b )</code>: swap the top two
pairs</li>
<li>
<code>2DUP ( a b -- a b a b )</code>: duplicate the top pair</li>
<li>
<code>2OVER ( p1 p2 -- p1 p2 p1 )</code>: duplicate the second pair
(<code>p1</code>) to the top</li>
<li>
<code>2DROP ( a b -- )</code>: discard the top pair</li>
</ul>
</div>
<div class="section level2">
<h2 id="two-stacks">Two stacks?<a class="anchor" aria-label="anchor" href="#two-stacks"></a>
</h2>
<p><code>froth</code> actually has two stacks. The main one, the
parameter stack, is what you’ll spend the majority of your time working
with. Whenever we “push to the stack”, that’s referring to the parameter
stack.</p>
<p>However, <code>froth</code> also has a second stack called the Return
Stack. It’s possible for you to use this stack as a sort of “temporary
space” to hold values while you process other things. It’s very
important to ensure you clear the values on this temporary stack before
you finish processing! <code>froth</code> is much more forgiving than
Forth on this point, but it’s good to get in the practice of good Forth
code.</p>
<ul>
<li>
<code>&gt;R ( n -- )</code>: moves the value on the parameter stack
to the return stack</li>
<li>
<code>R&gt; ( -- n )</code>: moves the value on the return stack to
the parameter stack</li>
<li>
<code>R@ ( -- n )</code>: copies the value on the return stack to
the parameter stack</li>
</ul>
<p>This can sometimes be very useful. For instance, say we wanted to
swap the second and third elements of the stack (that is, go from
<code>2 3 1</code> to <code>3 2 1</code>). We can do this with:</p>
<pre><code>fr&gt; 2 3 1
ok.
fr&gt; &gt;R SWAP R&gt;
ok.
fr&gt; .s
[[1]]
[1] 1

[[2]]
[1] 2

[[3]]
[1] 3

[[4]]
NULL

ok.</code></pre>
<p><em>Fundamental Forth</em> gives an excellent example of using these
operators: suppose we want to write a function
<code>quadratic ( a b c x -- n )</code> that returns
<code>ax^2 + bx + c</code>.</p>
<pre><code>fr&gt; : QUADRATIC ( a b c x -- n ) &gt;r swap rot r@ * + r&gt; * + ; 
ok.
fr&gt; 2 7 9 3 quadratic .
48 ok.</code></pre>
</div>
<div class="section level2">
<h2 id="other-miscellaneous-operators">Other Miscellaneous operators<a class="anchor" aria-label="anchor" href="#other-miscellaneous-operators"></a>
</h2>
<p>For completeness, here are some other arithmetic operations:</p>
<ul>
<li>
<code>1+ ( n1 -- n2 )</code>: adds 1</li>
<li>
<code>1- ( n1 -- n2 )</code>: subtracts 1</li>
<li>
<code>2+ ( n1 -- n2 )</code>: adds 2</li>
<li>
<code>2- ( n1 -- n2 )</code>: subtracts 2</li>
<li>
<code>2* ( n1 -- n2 )</code>: multiplies by 2</li>
<li>
<code>2/ ( n1 -- n2 )</code>: divides by 2</li>
</ul>
<p>We also have some funky double operators:</p>
<ul>
<li>
<code>*/ ( a b c -- n )</code>: pushes <code>(a*b) / c</code>
</li>
<li>
<code>*/mod ( a b c -- rem quot )</code>: pushes the remainder and
quotient of <code>(a*b) %/% c</code>
</li>
</ul>
<p>If you’re coming from Forth, you may recognize these are operations
using double-length values as intermediates for increased precision.
However, since <code>froth</code> uses R internals for operations,
there’s no difference between single and double length values.</p>
</div>
<div class="section level2">
<h2 id="words-in-this-chapter">Words in this chapter<a class="anchor" aria-label="anchor" href="#words-in-this-chapter"></a>
</h2>
<ul>
<li>
<code>/ ( a b -- n )</code>: division
(<code>5 2 / =&gt; 2.5</code>)</li>
<li>
<code>%/% ( a b -- n)</code>: integer division
(<code>5 2 %/% =&gt; 2</code>)</li>
<li>
<code>mod ( a b -- rem )</code>: remainder when dividing
<code>a / b</code>
</li>
<li>
<code>/mod ( a b -- rem quot )</code>: integer divides
<code>a %/% b</code>, pushes the remainder and then the quotient</li>
<li>
<code>^ ( a b -- n )</code>: raises <code>a^b</code>
</li>
<li>
<code>negate ( a -- n )</code>: negates <code>a</code>
</li>
<li>
<code>abs ( a -- n )</code>: takes the absolute value of
<code>a</code>
</li>
<li>
<code>min ( a b -- min )</code>: pushes <code>min(a,b)</code>
</li>
<li>
<code>max ( a b -- max )</code>: pushes <code>max(a,b)</code>
</li>
<li>
<code>sqrt ( a -- root )</code>: pushes <code>sqrt(a)</code>
</li>
<li>
<code>SWAP ( a b -- b a )</code>: swap top two stack elements</li>
<li>
<code>DUP ( n -- n n )</code>: duplicate the top stack element</li>
<li>
<code>OVER ( a b -- a b a )</code>: duplicate the second element to
the top of the stack</li>
<li>
<code>ROT ( a b c -- b c a )</code>: rotate the third item to the
top</li>
<li>
<code>DROP ( n -- )</code>: discard the top element of the
stack</li>
<li>
<code>.S ( -- )</code>: print out the contents of the stack</li>
<li>
<code>2SWAP ( a b c d -- c d a b )</code>: swap the top two
pairs</li>
<li>
<code>2DUP ( a b -- a b a b )</code>: duplicate the top pair</li>
<li>
<code>2OVER ( p1 p2 -- p1 p2 p1 )</code>: duplicate the second pair
(<code>p1</code>) to the top</li>
<li>
<code>2DROP ( a b -- )</code>: discard the top pair</li>
<li>
<code>&gt;R ( n -- )</code>: moves the value on the parameter stack
to the return stack</li>
<li>
<code>R&gt; ( -- n )</code>: moves the value on the return stack to
the parameter stack</li>
<li>
<code>R@ ( -- n )</code>: copies the value on the return stack to
the parameter stack</li>
<li>
<code>1+ ( n1 -- n2 )</code>: adds 1</li>
<li>
<code>1- ( n1 -- n2 )</code>: subtracts 1</li>
<li>
<code>2+ ( n1 -- n2 )</code>: adds 2</li>
<li>
<code>2- ( n1 -- n2 )</code>: subtracts 2</li>
<li>
<code>2* ( n1 -- n2 )</code>: multiplies by 2</li>
<li>
<code>2/ ( n1 -- n2 )</code>: divides by 2</li>
<li>
<code>*/ ( a b c -- n )</code>: pushes <code>(a*b) / c</code>
</li>
<li>
<code>*/mod ( a b c -- rem quot )</code>: pushes the remainder and
quotient of <code>(a*b) %/% c</code>
</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Aidan Lakshman.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
